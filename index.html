<!doctype html>



  


<html class="theme-next mist use-motion">
<head>
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>



<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />












  <link href="/vendors/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css"/>




  <link href="//fonts.googleapis.com/css?family=Lato:300,400,700,400italic&subset=latin,latin-ext" rel="stylesheet" type="text/css">



<link href="/vendors/font-awesome/css/font-awesome.min.css?v=4.4.0" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=0.5.0" rel="stylesheet" type="text/css" />


  <meta name="keywords" content="Hexo, NexT" />








  <link rel="shortcut icon" type="image/x-icon" href="/favicon.ico?v=0.5.0" />






<meta name="description" content="网络协议分析、爬虫、python、TensorFlow，以及各种让我痴迷的新技术。">
<meta property="og:type" content="website">
<meta property="og:title" content="乾坤袋">
<meta property="og:url" content="http://closethe.github.io/index.html">
<meta property="og:site_name" content="乾坤袋">
<meta property="og:description" content="网络协议分析、爬虫、python、TensorFlow，以及各种让我痴迷的新技术。">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="乾坤袋">
<meta name="twitter:description" content="网络协议分析、爬虫、python、TensorFlow，以及各种让我痴迷的新技术。">



<script type="text/javascript" id="hexo.configuration">
  var NexT = window.NexT || {};
  var CONFIG = {
    scheme: 'Mist',
    sidebar: {"position":"left","display":"post"},
    fancybox: true,
    motion: true,
    duoshuo: {
      userId: 0,
      author: '博主'
    }
  };
</script>

  <title> 乾坤袋 </title>
</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-Hans">

  



  <script type="text/javascript">
    var _hmt = _hmt || [];
    (function() {
      var hm = document.createElement("script");
      hm.src = "//hm.baidu.com/hm.js?2b87d502f8e3c62d1017959c53c2c8c1";
      var s = document.getElementsByTagName("script")[0];
      s.parentNode.insertBefore(hm, s);
    })();
  </script>






  
  
    
  

  <div class="container one-collumn sidebar-position-left 
   page-home 
 ">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-meta ">
  

  <div class="custom-logo-site-title">
    <a href="/"  class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <span class="site-title">乾坤袋</span>
      <span class="logo-line-after"><i></i></span>
    </a>
  </div>
  <p class="site-subtitle">如果能跟onenote打通就好.</p>
</div>

<div class="site-nav-toggle">
  <button>
    <span class="btn-bar"></span>
    <span class="btn-bar"></span>
    <span class="btn-bar"></span>
  </button>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-home fa-fw"></i> <br />
            
            首页
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives" rel="section">
            
              <i class="menu-item-icon fa fa-archive fa-fw"></i> <br />
            
            归档
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags" rel="section">
            
              <i class="menu-item-icon fa fa-tags fa-fw"></i> <br />
            
            标签
          </a>
        </li>
      

      
    </ul>
  

  
</nav>

 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            
  <section id="posts" class="posts-expand">
    
      

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2018/03/16/导出excel文件实现/" itemprop="url">
                  web2py导出excel文件实现
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">发表于</span>
            <time itemprop="dateCreated" datetime="2018-03-16T11:27:04+08:00" content="2018-03-16">
              2018-03-16
            </time>
          </span>

          

          
            
              <span class="post-comments-count">
                &nbsp; | &nbsp;
                <a href="/2018/03/16/导出excel文件实现/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count ds-thread-count" data-thread-key="2018/03/16/导出excel文件实现/" itemprop="commentsCount"></span>
                </a>
              </span>
            
          

          

          
          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2>csv文件导出</h2>
<p>项目需要将数据库中的数据导出为文件，csv文件采用&quot;,&quot;号作为列分隔符，&quot;\n&quot;换行作为行分隔符，易于操作，所以最开始只支持导出为csv文件。</p>
<h2>excel文件导出</h2>
<p>后来用户需求变动，不仅仅希望能看到数据，还需要进行一些公式计算、格式变换等高级操作，这时csv就远远不能满足了，其次，如果数据中出现了&quot;,&quot;号，会扰乱数据格式，使得excel在解析csv时数据错误。</p>
<p>于是研究如果扩展web2py，实现excel数据的导出和下载。</p>
<h2>例子</h2>
<p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line">def data_history_normal():</span><br><span class="line">	search = request.vars[&apos;search&apos;]</span><br><span class="line">    q = ((db.data_paymentform.isvalid ==1)&amp;(db.data_paymentform.finish !=None))</span><br><span class="line">    if (search !=&quot;&quot;) &amp; (search != None):</span><br><span class="line">        search = json.loads(search)</span><br><span class="line">        for item in search:</span><br><span class="line">            if  search[item] !=&quot;&quot;:</span><br><span class="line">                if item==&quot;times&quot;:</span><br><span class="line">                    s_t,e_t = search[item].split(&quot;::&quot;)</span><br><span class="line">                    s_t = datetime.datetime.strptime(s_t,&quot;%Y-%m-%d %H:%M:%S&quot;)</span><br><span class="line">                    e_t = datetime.datetime.strptime(e_t,&quot;%Y-%m-%d %H:%M:%S&quot;)</span><br><span class="line">                    s_t_str = s_t.strftime(&quot;%Y年%m月%d日&quot;)</span><br><span class="line">                    e_t_str = e_t.strftime(&quot;%Y年%m月%d日&quot;)</span><br><span class="line">                    q &amp;= ((db.data_paymentform.schooltime &gt;= s_t_str)&amp;(db.data_paymentform.schooltime &lt;= e_t_str))</span><br><span class="line">                else:</span><br><span class="line">                    q &amp;= (db.data_paymentform[item].like(&quot;%&quot;+search[item]+&quot;%&quot;))</span><br><span class="line">    q &amp;= (db.data_paymentform.payment ==u&quot;代发&quot;)</span><br><span class="line">	# 获得数据库导出的数据[&#123;&#125;,&#123;&#125;]</span><br><span class="line">	datas = db(q).select()</span><br><span class="line">	############################################</span><br><span class="line">	#				excel写入				   #</span><br><span class="line">	############################################</span><br><span class="line">	# 创建excel，数据编码格式采用utf-8</span><br><span class="line">	ws = Workbook(encoding=&apos;utf-8&apos;)</span><br><span class="line">	# 创建工作sheet，名字为&quot;数据导出&quot;</span><br><span class="line">	w = ws.add_sheet(u&quot;数据导出&quot;)</span><br><span class="line">	# 逐行写入数据</span><br><span class="line">	line=0</span><br><span class="line">	for item in datas:</span><br><span class="line">	    # write(行号，列号，内容)</span><br><span class="line">	    w.write(line,0,item[&quot;id&quot;])</span><br><span class="line">	    w.write(line,1,&quot;id&quot;)</span><br><span class="line">	    line +=1</span><br><span class="line">	s = StringIO.StringIO()</span><br><span class="line">	# 保存excel文件内容到tringIO</span><br><span class="line">	ws.save(s)</span><br><span class="line">	s.seek(0)</span><br><span class="line">	# 修改http响应头</span><br><span class="line">	response.headers[&apos;Content-Type&apos;] = &apos;application/vnd.ms-excel&apos;</span><br><span class="line">	response.headers[&apos;Content-Disposition&apos;] = &apos;attachment; filename=test.xls&apos;</span><br><span class="line">	# 返回数据</span><br><span class="line">	return s.getvalue()</span><br></pre></td></tr></table></figure></p>

          
        
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2018/01/03/常见网络抓包方案/" itemprop="url">
                  常见网络抓包方案
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">发表于</span>
            <time itemprop="dateCreated" datetime="2018-01-03T10:07:24+08:00" content="2018-01-03">
              2018-01-03
            </time>
          </span>

          

          
            
              <span class="post-comments-count">
                &nbsp; | &nbsp;
                <a href="/2018/01/03/常见网络抓包方案/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count ds-thread-count" data-thread-key="2018/01/03/常见网络抓包方案/" itemprop="commentsCount"></span>
                </a>
              </span>
            
          

          

          
          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2>背景</h2>
<p>抓包作为一项基本技能，不论开发调试还是破解研究都作用广泛。PC端使用wireshark、omnipeek作为基本的协议分析软件，如果是web协议分析可以使用Fiddler，当然从安全角度出发还有更强大的Burpsuite。
随着智能手机的普及，H5的发展壮大，越来越多的应用软件开始采用HybridApp方式。这当然就包括了大名鼎鼎的淘宝，还有“臭名昭著”的北京交警APP（每次凌晨两点起来办进京证都要暗暗的骂上一句）。现在日益茁壮的微信小程序、刚上幼儿园的微信小游戏也使用了相关的技术。对他们的研究分析自然少不了抓包了。</p>
<hr>
<h2>问题</h2>
<p>PC抓包已经是很古老的技艺了，在此就不多赘述了。智能手机抓包有没有什么好的解决方案呢？
（只用过安卓手机，这里就不讨论苹果手机了）</p>
<hr>
<h2>抓原始数据</h2>
<h3>1、tcpdump抓包 （所有数据包  需要root）</h3>
<p>此方案需要root，下载tcpdump程序，复制到手机目录下，修改运行权限并进行抓包。
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">tcpdump -p -vv -s 0 -w /sdcard/capture.pcap</span><br></pre></td></tr></table></figure></p>
<p>之后使用adb pull将文件抓取到电脑上使用wireshark进行分析。</p>
<h3>2、局域网抓包 (所有数据包  不需要root)</h3>
<p>靶机与抓包机部署在同一个局域网内，抓包机网卡设置为混杂模式进行抓包。</p>
<hr>
<h2>抓http/https数据</h2>
<h3>1、Packet Capture之类 模拟vpn通道  (手机本地抓取)</h3>
<p>通过安卓提供的VpnService，模拟中间人攻击，汇集所有手机流量进行抓包记录。并将抓取的网络数据存储到本地。</p>
<h3>2、网络代理抓包 (Fiddler、Burpsuite)</h3>
<p>这里以Fiddler为例，Burpsuite类似的设置。主要的使用流程分为以下几步：</p>
<blockquote>
<ul>
<li>电脑端安装设置代理软件</li>
<li>手机端连接代理并安装证书</li>
<li>手机端使用待分析软件或访问网络</li>
<li>电脑端分析数据</li>
</ul>
</blockquote>
<p>具体使用步骤如下：</p>
<blockquote>
<p>1、 下载最新版 Fiddler 并进行安装。
2、 安装完成后点击 Tools-&gt;Option进行设置,
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">https标签：</span><br><span class="line">    - [x] Capture HTTPS CONNECTS</span><br><span class="line">    - [x] Decrypt HTTPS traffic</span><br><span class="line">connections标签：</span><br><span class="line">    - [x] Allow romote computers to connect</span><br><span class="line">```  </span><br><span class="line">&gt; 3、 记录当前电脑的IP地址为IP_PC</span><br><span class="line">&gt; 4、 手机端连接局域网，并设置代理地址为IP_PC，端口：8888</span><br><span class="line">&gt; 5、 打开浏览器，访问地址http://IP_PC:8888，在打开的页面中下载fiddler的CA证书并进行安装。</span><br></pre></td></tr></table></figure></p>
</blockquote>
<p>也可以将证书下载到手机存储卡，之后使用 设置-&gt;系统安全-&gt;从存储设备安装 进行证书安装 (小米6 开发版)。</p>
<pre><code>&gt; 6、 打开应用进行操作，即可在电脑上看到对应的http/https数据包。

## 总结

第一次手机抓HTTPS包遇到了很多问题，后来都逐个解决了。现在回想起来，这些问题已经忘光了。
嗯 就是这样。</code></pre>

          
        
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2017/12/29/python远程过程调用记录/" itemprop="url">
                  python远程过程调用记录
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">发表于</span>
            <time itemprop="dateCreated" datetime="2017-12-29T11:23:53+08:00" content="2017-12-29">
              2017-12-29
            </time>
          </span>

          

          
            
              <span class="post-comments-count">
                &nbsp; | &nbsp;
                <a href="/2017/12/29/python远程过程调用记录/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count ds-thread-count" data-thread-key="2017/12/29/python远程过程调用记录/" itemprop="commentsCount"></span>
                </a>
              </span>
            
          

          

          
          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2>需求</h2>
<p>现有的两个web服务器之间需要打通传递数据，A应用采集数据发送给B应用处理，B处理后再存储到自己的数据库。</p>
<p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">A服务器-&gt;B服务器: 刚刚采集到新鲜热乎的数据一份！</span><br><span class="line">Note right of B服务器: 尝一口，扔冰箱里</span><br><span class="line">B服务器--&gt;A服务器: 不错！是挺新鲜的！</span><br></pre></td></tr></table></figure></p>
<h2>方案</h2>
<blockquote>
<ul>
<li>方案一、A服务器采集数据后，按照B的需求进行加工处理，扔进B的数据库中。</li>
<li>方案二、A调用B的处理过程，B处理完后存入数据库。这就是远程过程调用(RPC)。</li>
</ul>
</blockquote>
<p>方案一将A、B之间的联动转化为A与B数据库的联动。此方案增加了系统间的耦合，降低了系统的稳定性，增加了维护成本，也带来了安全隐患。方案二A、B之间保持了独立性，减少了相互干扰，提升了稳定性。所以这里采用方案二来实现。</p>
<p>如何使用rpc调用，有两个方面问题:</p>
<blockquote>
<ul>
<li>一、B服务器作为服务提供方，以何种方式提供服务？</li>
<li>二、A服务器作为调用方，如何调用B所提供的服务？</li>
</ul>
</blockquote>
<h2>web2py解决方案</h2>
<h3>一、服务器解决方案</h3>
<p>B服务器采用python的web2py作为web服务器框架，在官网我们找到了RPC相关的文档说明，框架提供了多种<a href="http://web2py.com/books/default/chapter/29/10/services#Remote-procedure-calls" target="_blank" rel="external">RPC协议的支持</a>。XMLRPC、JSONRPC、AMFRPC、SOAP等，权衡一下，选择了<a href="http://web2py.com/books/default/chapter/29/10/services#XMLRPC" target="_blank" rel="external">xmlrpc</a>在调用时不需要再引入第三方库，使用会更方便。
web2py采用了典型的mvc框架，项目里controls目录下对应了所以页面请求的处理函数。修改对应的control文件并添加下面的代码。例：default.py。
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@service.xmlrpc</span></span><br><span class="line"><span class="comment">#RPC服务测试函数 ，注：每一个提供服务的函数需要加上@service.xmlrpc作为修饰符</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">add</span><span class="params">(a, b)</span>:</span></span><br><span class="line">    <span class="keyword">return</span> a + b</span><br><span class="line">    </span><br><span class="line"><span class="comment">#开启RPC服务接口</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">call</span><span class="params">()</span>:</span></span><br><span class="line">    session.forget()</span><br><span class="line">    <span class="keyword">return</span> service()</span><br></pre></td></tr></table></figure></p>
<p>主要工作分两步，1、添加call函数，开启RPC服务支持。2、为提供RPC服务的函数增加@service.xmlrpc修饰符。
就是这么简单，服务器端的配置就结束了，这里B服务器开启了add服务，将传入的两个参数相加并返回。</p>
<h3>二、客户端解决方案</h3>
<p>工作很简单，引入xmlrpclib包里的ServerProxy类，传入B服务器的url进行初始化，之后按照对象的方式进行调用。下面是客户端的测试代码。http://127.0.0.1:8000/app/default/call/xmlrpc是B服务器的网络链接地址。
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="keyword">from</span> xmlrpclib <span class="keyword">import</span> ServerProxy</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>server = ServerProxy(</span><br><span class="line">       <span class="string">'http://127.0.0.1:8000/app/default/call/xmlrpc'</span>)</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="keyword">print</span> server.add(<span class="number">3</span>, <span class="number">4</span>)</span><br><span class="line"><span class="number">7</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="keyword">print</span> server.add(<span class="string">'hello'</span>,<span class="string">'world'</span>)</span><br><span class="line"><span class="string">'helloworld'</span></span><br></pre></td></tr></table></figure></p>
<h2>通用python网络服务解决方案</h2>
<p>web2py作为web服务框架，对基于http协议实现的rpc服务具有天然的优势，服务器不需要再开启其他的网络服务。然而其他提供没有采用web2py框架的服务器该如何提供RPC服务呢。
最近的开发工作中，我们也遇到了这样的问题。此时的B服务器不是web服务器。</p>
<h3>一、服务器解决方案</h3>
<p>考虑到之前采用了xmlrpc实现远程过程调用，具有了一定的经验，功能上也满足了我们的需求，所以采用搭建xmlrpc服务的方式进行。
在B服务器中添加下面的代码，使用多进程的方式，开启xmlrpc服务器，并绑定到服务器的8088端口。
这里也是提供了add函数作为服务，并返回两个参数相加的接口。
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">run_xmlrpcserver</span><span class="params">()</span>:</span></span><br><span class="line">    <span class="keyword">from</span> SimpleXMLRPCServer <span class="keyword">import</span> SimpleXMLRPCServer</span><br><span class="line">    <span class="keyword">from</span> SocketServer <span class="keyword">import</span> ThreadingMixIn</span><br><span class="line">    <span class="class"><span class="keyword">class</span> <span class="title">ThreadXMLRPCServer</span><span class="params">(ThreadingMixIn, SimpleXMLRPCServer)</span>:</span></span><br><span class="line">        <span class="keyword">pass</span></span><br><span class="line"></span><br><span class="line">    <span class="class"><span class="keyword">class</span> <span class="title">MyObject</span>:</span></span><br><span class="line">        <span class="function"><span class="keyword">def</span> <span class="title">add</span><span class="params">(self,a,b)</span>:</span></span><br><span class="line">            <span class="keyword">return</span> a+b</span><br><span class="line"></span><br><span class="line">    obj = MyObject()</span><br><span class="line">    server = ThreadXMLRPCServer((<span class="string">"localhost"</span>, <span class="number">8088</span>), allow_none=<span class="keyword">True</span>)</span><br><span class="line">    server.register_instance(obj)</span><br><span class="line">    server.serve_forever()</span><br><span class="line"><span class="comment"># 开启服务器进程</span></span><br><span class="line">Process(target=run_xmlrpcserver, args=tuple([ ])).start()</span><br></pre></td></tr></table></figure></p>
<h3>二、客户端解决方案</h3>
<p>这里的代码与web2py解决方案中的一致，注意修改下服务的url即可，具体测试代码如下：
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span>server = xmlrpclib.ServerProxy(<span class="string">"http://localhost:8088"</span>)</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>words = server.add(<span class="number">1</span>,<span class="number">2</span>)</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>words</span><br><span class="line"><span class="number">3</span></span><br></pre></td></tr></table></figure></p>
<h2>总结</h2>
<p>最近记性越来越差了，以后要多记录写才好。</p>

          
        
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2017/11/17/联通IPTV-ZTEB860AV1-2-ADB密码计算/" itemprop="url">
                  联通IPTV ZTEB860AV1.2 ADB密码计算
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">发表于</span>
            <time itemprop="dateCreated" datetime="2017-11-17T09:37:31+08:00" content="2017-11-17">
              2017-11-17
            </time>
          </span>

          

          
            
              <span class="post-comments-count">
                &nbsp; | &nbsp;
                <a href="/2017/11/17/联通IPTV-ZTEB860AV1-2-ADB密码计算/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count ds-thread-count" data-thread-key="2017/11/17/联通IPTV-ZTEB860AV1-2-ADB密码计算/" itemprop="commentsCount"></span>
                </a>
              </span>
            
          

          

          
          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2>需求</h2>
<p>办理的联通宽带，增送iptv，可惜一直没有电视。丈母娘家的小旅馆歇业了，趁个周末就去搬了台电视回来。当时正值S赛期间，iptv盒子不能装直播软件看比赛，确实不爽。</p>
<h2>方案</h2>
<p>上网研究了半天，发现这款盒子可以通过打开远程ADB的方式远程安装app。不过开启远程ADB却需要密码。</p>
<h2>原由</h2>
<p>论坛上有个“三无”APP，安装后输入随机数和mac地址可以计算出密码。出于对“三无”APP缺失安全感，也是因为好奇，决定逆向看看这个密码是怎么算出来的。</p>
<h2>开动吧</h2>
<p>apk改后缀名zip，提取so扔进ida。
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">int</span> __<span class="function">fastcall <span class="title">getHashcode</span><span class="params">(<span class="keyword">char</span> *a1, <span class="keyword">char</span> *a2)</span></span><br><span class="line"></span>&#123;</span><br><span class="line">  <span class="keyword">char</span> *v2; <span class="comment">// r6@1</span></span><br><span class="line">  <span class="keyword">char</span> *v3; <span class="comment">// r5@1</span></span><br><span class="line">  <span class="keyword">int</span> v4; <span class="comment">// r2@1</span></span><br><span class="line">  <span class="keyword">int</span> v5; <span class="comment">// r3@1</span></span><br><span class="line">  <span class="keyword">int</span> v6; <span class="comment">// r0@1</span></span><br><span class="line">  <span class="keyword">int</span> result; <span class="comment">// r0@1</span></span><br><span class="line">  <span class="keyword">char</span> s; <span class="comment">// [sp+1Ch] [bp-114h]@1</span></span><br><span class="line">  <span class="keyword">char</span> v9; <span class="comment">// [sp+9Ch] [bp-94h]@1</span></span><br><span class="line">  <span class="keyword">int</span> v10; <span class="comment">// [sp+11Ch] [bp-14h]@1</span></span><br><span class="line"></span><br><span class="line">  v2 = a1;</span><br><span class="line">  v3 = a2;</span><br><span class="line">  v10 = _stack_chk_guard;</span><br><span class="line">  <span class="built_in">printf</span>(<span class="string">"rand =%s\n"</span>, a1);</span><br><span class="line">  <span class="built_in">printf</span>(<span class="string">"mac =%s\n"</span>, v3);</span><br><span class="line">  <span class="built_in">memset</span>(&amp;s, <span class="number">0</span>, <span class="number">0x80</span>u);</span><br><span class="line">  <span class="built_in">memset</span>(&amp;v9, <span class="number">0</span>, <span class="number">0x80</span>u);</span><br><span class="line">  _sprintf_chk(&amp;s, <span class="number">0</span>, <span class="number">128</span>, <span class="string">"%s%s%s%s%s"</span>, <span class="string">"open_ADB"</span>, v2, <span class="string">"@"</span>, v3, <span class="string">"ZTE_ENCRYPT"</span>);</span><br><span class="line">  <span class="built_in">printf</span>(<span class="string">"MD5 %s\n"</span>, &amp;s);</span><br><span class="line">  md5_string(&amp;s, (<span class="keyword">int</span>)&amp;v9, v4, v5);</span><br><span class="line">  <span class="built_in">printf</span>(<span class="string">"chashnum %s\n"</span>, &amp;v9);</span><br><span class="line">  v6 = hashcode(&amp;v9);</span><br><span class="line">  <span class="built_in">printf</span>(<span class="string">"%d\n"</span>, v6);</span><br><span class="line">  result = hashcode(&amp;v9);</span><br><span class="line">  <span class="keyword">if</span> ( v10 != _stack_chk_guard )</span><br><span class="line">    _stack_chk_fail(result);</span><br><span class="line">  <span class="keyword">return</span> result;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> __<span class="function">fastcall <span class="title">hashcode</span><span class="params">(<span class="keyword">const</span> <span class="keyword">char</span> *a1)</span></span><br><span class="line"></span>&#123;</span><br><span class="line">  <span class="keyword">const</span> <span class="keyword">char</span> *v1; <span class="comment">// r6@1</span></span><br><span class="line">  <span class="keyword">int</span> v2; <span class="comment">// r0@1</span></span><br><span class="line">  <span class="keyword">int</span> v3; <span class="comment">// r2@2</span></span><br><span class="line">  <span class="keyword">signed</span> <span class="keyword">int</span> v4; <span class="comment">// r12@2</span></span><br><span class="line">  <span class="keyword">int</span> v5; <span class="comment">// r1@3</span></span><br><span class="line">  <span class="keyword">int</span> result; <span class="comment">// r0@6</span></span><br><span class="line">  <span class="keyword">char</span> s[<span class="number">1024</span>]; <span class="comment">// [sp+4h] [bp-414h]@1</span></span><br><span class="line">  <span class="keyword">int</span> v8; <span class="comment">// [sp+404h] [bp-14h]@1</span></span><br><span class="line"></span><br><span class="line">  v1 = a1;</span><br><span class="line">  v8 = _stack_chk_guard;</span><br><span class="line">  <span class="built_in">memset</span>(s, <span class="number">0</span>, <span class="number">0x400</span>u);</span><br><span class="line">  _strcpy_chk(s, v1, <span class="number">1024</span>);</span><br><span class="line">  v2 = _strlen_chk(s, <span class="number">1024</span>);</span><br><span class="line">  <span class="keyword">if</span> ( v2 )</span><br><span class="line">  &#123;</span><br><span class="line">    v3 = <span class="number">0</span>;</span><br><span class="line">    v4 = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">do</span></span><br><span class="line">    &#123;</span><br><span class="line">      v5 = (<span class="keyword">unsigned</span> __int8)s[v3++];</span><br><span class="line">      v4 = v5 + <span class="number">31</span> * v4;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">while</span> ( v3 != v2 );</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">else</span></span><br><span class="line">  &#123;</span><br><span class="line">    v4 = <span class="number">0</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  result = (v4 ^ (v4 &gt;&gt; <span class="number">31</span>)) - (v4 &gt;&gt; <span class="number">31</span>);</span><br><span class="line">  <span class="keyword">if</span> ( v8 != _stack_chk_guard )</span><br><span class="line">    _stack_chk_fail(result);</span><br><span class="line">  <span class="keyword">return</span> result;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>getHashcode函数参数，a1是随机数，a2是mac地址。
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">text = <span class="string">"open_ADB"</span>, v2, <span class="string">"@"</span>, v3, <span class="string">"ZTE_ENCRYPT"</span></span><br><span class="line">hash =md5(text)</span><br><span class="line"><span class="keyword">pass</span> = hashcode(hash)</span><br></pre></td></tr></table></figure></p>
<p>hashcode就是计算一个校验值。</p>
<h2>后续</h2>
<p>等有时间了，把hashcode的计算改成python仍在web上，做个在线计算。</p>

          
        
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2017/07/13/ajax接口测试方法/" itemprop="url">
                  ajax接口测试方法
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">发表于</span>
            <time itemprop="dateCreated" datetime="2017-07-13T11:45:45+08:00" content="2017-07-13">
              2017-07-13
            </time>
          </span>

          

          
            
              <span class="post-comments-count">
                &nbsp; | &nbsp;
                <a href="/2017/07/13/ajax接口测试方法/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count ds-thread-count" data-thread-key="2017/07/13/ajax接口测试方法/" itemprop="commentsCount"></span>
                </a>
              </span>
            
          

          

          
          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2>需求</h2>
<p>web项目的开发中，ajax是前端通讯的常见方式，在前后端分离的开发过程中，后端接口的可独立测试就尤为重要。</p>
<h2>方案</h2>
<p>我们前端采用了jquery、bootstrap的框架方案，jquery提供了简单便利的ajax调用接口，所以，我们只要在项目的任何一个页面下，F12开启调试，在console中使用jquery提供的ajax函数就可以测试接口。</p>
<h2>案例</h2>
<p>这里以data_project.json?type=import接口为例，
我们先创建一个对象t，用来填充接口所需要的参数，
之后使用$.ajax函数进行测试。
并在回调函数success，error中查看接口的返回结果。
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">var t = new Object();</span><br><span class="line">t.projectid = &quot;16256&quot;;</span><br><span class="line">t.projectname =&quot;营销管理高级研修班&quot;</span><br><span class="line">t.projecttype = &quot;普通项目&quot;;</span><br><span class="line">t.starttime = &quot;20160520&quot;;</span><br><span class="line">t.endtime = &quot;20170920&quot;;</span><br><span class="line">t.categoty = &quot;企业管理/工商管理&quot;;</span><br><span class="line">t.student = &quot;公司企业管理人员&quot;;</span><br><span class="line">t.status = &quot;学校已同意&quot;;</span><br><span class="line">t.accepttime = &quot;2016-04-12&quot;;</span><br><span class="line"></span><br><span class="line">$.ajax(&#123;type: &quot;POST&quot;,</span><br><span class="line">    contentType: &quot;application/json;charset=utf-8&quot;,</span><br><span class="line">    url: &quot;data_project.json?type=import&quot;,</span><br><span class="line">    data: JSON.stringify(t),</span><br><span class="line">    dataType: &quot;json&quot;,</span><br><span class="line">    success: function (result) &#123;</span><br><span class="line">        console.log(result);</span><br><span class="line">    &#125;,</span><br><span class="line">    error: function (result, status) &#123;</span><br><span class="line">        console.log(result);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure></p>

          
        
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2017/06/19/mongodb简单操作笔记/" itemprop="url">
                  mongodb简单操作笔记
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">发表于</span>
            <time itemprop="dateCreated" datetime="2017-06-19T11:17:07+08:00" content="2017-06-19">
              2017-06-19
            </time>
          </span>

          

          
            
              <span class="post-comments-count">
                &nbsp; | &nbsp;
                <a href="/2017/06/19/mongodb简单操作笔记/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count ds-thread-count" data-thread-key="2017/06/19/mongodb简单操作笔记/" itemprop="commentsCount"></span>
                </a>
              </span>
            
          

          

          
          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2>部署</h2>
<p>1、下载
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">选择windows msi版本。</span><br></pre></td></tr></table></figure></p>
<p>2、启动 mongo
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">.\bin\mongod.exe --auth --logpath=&quot;e:\mongodb\log\mongodb.log&quot; --logappend --dbpath=&quot;e:\mongodb\data\db&quot;</span><br></pre></td></tr></table></figure></p>
<p>3、设置密码
去掉--auth选项，开启无需认证模式。
运行mongo.exe 进入控制台。
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">//进入admin管理库</span><br><span class="line">use admin</span><br><span class="line">//添加用户jiutian 权限：可以读写任何数据库</span><br><span class="line">db.createUser(&#123;user:&quot;jiutian&quot;,pwd:&quot;2946581&quot;,roles[&#123;role:&quot;readWriteAnyDatabase&quot;,db:&quot;admin&quot;&#125;]&#125;)</span><br><span class="line">注意：</span><br><span class="line">    如果MongoVue连接不上，需要关闭SCRAM-SHA-1认证。</span><br><span class="line">    解决方法：删除用户，关闭SCRAM-SHA-1认证，新建用户。</span><br><span class="line">#关闭SCRAM-SHA-1认证方式</span><br><span class="line">&gt; use admin </span><br><span class="line">switched to db admin </span><br><span class="line">&gt; var schema = db.system.version.findOne(&#123;&quot;_id&quot; : &quot;authSchema&quot;&#125;) </span><br><span class="line">&gt; schema.currentVersion = 3 </span><br><span class="line">3 </span><br><span class="line">&gt; db.system.version.save(schema) </span><br><span class="line">WriteResult(&#123; &quot;nMatched&quot; : 1, &quot;nUpserted&quot; : 0, &quot;nModified&quot; : 1 &#125;) </span><br><span class="line">#删除用户</span><br><span class="line">&gt; db.dropUser(&quot;myuser&quot;) </span><br><span class="line">true</span><br></pre></td></tr></table></figure></p>
<h2>使用</h2>
<p>1、连接
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">mongo_client = pymongo.MongoClient(<span class="string">'mongodb://jiutian:2946581@localhost'</span>,<span class="number">27017</span>)</span><br><span class="line"><span class="comment">#数据库名：jiutian</span></span><br><span class="line">db = mongo_client.jiutian</span><br><span class="line"><span class="comment">#表名：hot_lvyou_beijing</span></span><br><span class="line">collection_data = db.hot_lvyou_beijing</span><br><span class="line"><span class="comment">#表名：hot_lvyou_beijing_info</span></span><br><span class="line">collection_info = db.hot_lvyou_beijing_info</span><br></pre></td></tr></table></figure></p>
<p>2、增 查 改
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#插入新项 userinfo=&#123;"key":"value",...&#125;</span></span><br><span class="line">collection_info.insert(userinfo)</span><br><span class="line"><span class="comment">#多重查找</span></span><br><span class="line">user_infos = collection_info.find(&#123;<span class="string">'user_id'</span>:id&#125;)</span><br><span class="line"><span class="comment">#查找结果数目</span></span><br><span class="line">sum = user_infos.count()</span><br><span class="line"><span class="comment">#取出第一个结果</span></span><br><span class="line">dat = user_infos[<span class="number">0</span>]</span><br><span class="line"><span class="comment">#修改更新数据</span></span><br><span class="line">collection_info.update(&#123;<span class="string">'user_id'</span>:id&#125;,&#123;<span class="string">"$set"</span>:&#123;<span class="string">'pages'</span>:pages,<span class="string">'lasttime'</span>:datetime.datetime.now()&#125;&#125;)</span><br></pre></td></tr></table></figure></p>

          
        
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2017/05/10/mysql绿色版配置/" itemprop="url">
                  mysql绿色版配置
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">发表于</span>
            <time itemprop="dateCreated" datetime="2017-05-10T11:13:03+08:00" content="2017-05-10">
              2017-05-10
            </time>
          </span>

          

          
            
              <span class="post-comments-count">
                &nbsp; | &nbsp;
                <a href="/2017/05/10/mysql绿色版配置/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count ds-thread-count" data-thread-key="2017/05/10/mysql绿色版配置/" itemprop="commentsCount"></span>
                </a>
              </span>
            
          

          

          
          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2>配置</h2>
<p>1、my-default.ini 复制并改名为my.ini.
2、编辑my.ini 
    
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">#mysql根目录</span><br><span class="line">basedir =&quot;C:\Program Files\mysql-5.6.22-win32&quot;</span><br><span class="line">#数据文件存放目录</span><br><span class="line">datadir =&quot;C:\Program Files\mysql-5.6.22-win32\data&quot;</span><br><span class="line"># port = .....   端口，默认3306</span><br><span class="line"># server_id = .....  服务实例的唯一标识</span><br><span class="line"> </span><br><span class="line">#服务端的编码方式</span><br><span class="line">character-set-server=utf8</span><br></pre></td></tr></table></figure></p>
<h2>注册服务</h2>
<p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mysqld -install MySql --defaults-file=&quot;C:\Program Files\mysql-5.6.22-win32\my.ini&quot;</span><br></pre></td></tr></table></figure></p>
<h2>启动、停止服务</h2>
<p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">net start mysql</span><br><span class="line">net stop mysql</span><br></pre></td></tr></table></figure></p>
<h2>修改root密码</h2>
<p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mysqladmin -uroot -p password 123456</span><br></pre></td></tr></table></figure></p>

          
        
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2017/03/19/spark集群环境搭建/" itemprop="url">
                  spark集群环境搭建
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">发表于</span>
            <time itemprop="dateCreated" datetime="2017-03-19T11:04:40+08:00" content="2017-03-19">
              2017-03-19
            </time>
          </span>

          

          
            
              <span class="post-comments-count">
                &nbsp; | &nbsp;
                <a href="/2017/03/19/spark集群环境搭建/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count ds-thread-count" data-thread-key="2017/03/19/spark集群环境搭建/" itemprop="commentsCount"></span>
                </a>
              </span>
            
          

          

          
          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2>1、运行环境配置</h2>
<p>1、软件环境
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">scala-2.11.7.tgz</span><br><span class="line">spark-1.6.0-bin-hadoop2.6.tgz</span><br></pre></td></tr></table></figure></p>
<p>2、解压到 /usr/local目录下
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">sudo tar -zxvf scala-2.11.7.tgz -C /usr/local/</span><br><span class="line">sudo tar -zxvf spark-1.6.0-bin-hadoop2.6.tgz -C /usr/local/</span><br><span class="line">sudo mv /usr/local/scala-2.11.7 /usr/local/scala</span><br><span class="line">sudo mv /usr/local/spark-1.6.0  /usr/local/spark</span><br></pre></td></tr></table></figure></p>
<p>3、修改所有者
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">sudo chown -R jiutian:jiutian /usr/local/scala</span><br><span class="line">sudo chown -R jiutian:jiutian /usr/local/spark</span><br></pre></td></tr></table></figure></p>
<p>4、环境变量
修改/etc/environment文件，添加scala、spark信息。
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">JAVA_HOME=/usr/local/jdk1.8.0</span><br><span class="line">HADOOP_INSTALL=/usr/local/hadoop</span><br><span class="line">SCALA_HOME=/usr/local/scala</span><br><span class="line">SPARK_HOME=/usr/local/spark</span><br><span class="line">PATH=&quot;/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin:/usr/games:/usr/local/games:/usr/local/jdk1.8.0/bin:/usr/local/hadoop/bin:/usr/local/scala/bini:/usr/local/spark/bin&quot;</span><br></pre></td></tr></table></figure></p>
<p>5、环境测试
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">scala -version   //查看scala版本</span><br><span class="line">run-example SparkPi 10 //运行SparkPi例程</span><br></pre></td></tr></table></figure></p>
<h2>2、集群环境设置</h2>
<p>1、修改spark/conf目录下的slaves文件，添加集群机器
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"># A Spark Worker will be started on each of the machines listed below.</span><br><span class="line">slave1</span><br><span class="line">slave2</span><br></pre></td></tr></table></figure></p>
<p>2、将所有安装文件、配置文件同步到slave机器上。
3、开启spark
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">#需要先开启hadoop</span><br><span class="line">./sbin/start-all.sh</span><br></pre></td></tr></table></figure></p>
<p>4、查看jps进程
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">#master</span><br><span class="line">Master //进程</span><br><span class="line">#slave</span><br><span class="line">Worker //进程</span><br></pre></td></tr></table></figure></p>
<p>5、开启spark-shell</p>

          
        
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2017/02/03/hadoop集群环境搭建/" itemprop="url">
                  hadoop集群环境搭建
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">发表于</span>
            <time itemprop="dateCreated" datetime="2017-02-03T10:25:04+08:00" content="2017-02-03">
              2017-02-03
            </time>
          </span>

          

          
            
              <span class="post-comments-count">
                &nbsp; | &nbsp;
                <a href="/2017/02/03/hadoop集群环境搭建/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count ds-thread-count" data-thread-key="2017/02/03/hadoop集群环境搭建/" itemprop="commentsCount"></span>
                </a>
              </span>
            
          

          

          
          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2>网络拓扑</h2>
<p><img src="/.io//bec2d20b-cc76-47e8-993e-71d2a21e79e2.png" alt="网络拓扑图">
NN :namenode
RM:资源管理器
DN:datanode
NM:nodemanager
SNM:secondary namenode</p>
<h2>软件环境</h2>
<pre><code>ubuntu14.04 64Bit   (所有机器用户名 应当一样 hostname不同进行区分)
JDK 1.8
hadoop 2.6.4
</code></pre>
<h2>运行环境配置</h2>
<p>1、解压jdk		/usr/local/jdk1.8.0
    2、解压hadoop	/usr/local/hadoop
    3、sudo vi /etc/environment
               
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">JAVA_HOME=/usr/<span class="built_in">local</span>/jdk1.8.0</span><br><span class="line">HADOOP_INSTALL=/usr/<span class="built_in">local</span>/hadoop</span><br><span class="line">PATH=<span class="string">"/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin:/usr/games:/usr/local/games:/usr/local/jdk1.8.0/bin:/usr/local/hadoop/bin"</span>  </span><br><span class="line">```  </span><br><span class="line"><span class="comment">## 安装SSH并配置免密码登录</span></span><br><span class="line">    </span><br><span class="line">``` shell</span><br><span class="line">sudo apt-get install ssh</span><br><span class="line">ssh-keygen -t dsa -P <span class="string">''</span> ~/.ssh/id_rsa</span><br><span class="line">cat ~/.ssh/id_rsa.pub &gt;&gt; ~/.ssh/authorized_keys</span><br><span class="line">ssh localhost</span><br></pre></td></tr></table></figure></p>
<p>注意：
	将master机器上的id_rsa.pub添加到所有机器的authorized_keys文件中。</p>
<p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">scp ~/.ssh/id_rsa.pub jiutian@slave1:/home/jiutian/.ssh/master.pub</span><br><span class="line">//在slave1中执行下面语句</span><br><span class="line">cat ~/.ssh/master.pub &gt;&gt; ~/.ssh/authorized_keys</span><br></pre></td></tr></table></figure></p>
<h2>配置hadoop分布式</h2>
<h3>1、修改文件拥有者</h3>
<p>sudo chown -R jiutian:jiutian /usr/local/hadoop</p>
<h3>2、使用软连接切换运行环境</h3>
<pre><code>cp /usr/local/hadoop/etc/hadoop /usr/local/hadoop/etc/hadoop_clone
mv /usr/local/hadoop/etc/hadoop /usr/local/hadoop/etc/hadoop_clutser
ln -s /usr/local/hadoop/etc/hadoop_clutser /usr/local/hadoop/etc/hadoop
</code></pre>
<h3>3、配置分布式运行环境参数</h3>
<p>1、core-site.xml
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">configuration</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">property</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">name</span>&gt;</span>fs.default.name<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">value</span>&gt;</span>hdfs://master:9000/<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">property</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">name</span>&gt;</span>hadoop.tmp.dit<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">value</span>&gt;</span>/home/jiutian/hadoop_tmp<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">property</span>&gt;</span> </span><br><span class="line"><span class="tag">&lt;<span class="name">property</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">name</span>&gt;</span>fs.checkpoint.period<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">value</span>&gt;</span>3600<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">property</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">name</span>&gt;</span>fs.checkpoint.size<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">value</span>&gt;</span>67108864<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">configuration</span>&gt;</span></span><br></pre></td></tr></table></figure></p>
<p>2、hdfs-site.xml
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">&lt;configuration&gt;</span><br><span class="line">&lt;property&gt;</span><br><span class="line">&lt;name&gt;dfs.replication&lt;/name&gt;</span><br><span class="line">&lt;value&gt;2&lt;/value&gt;</span><br><span class="line">&lt;/property&gt;</span><br><span class="line">&lt;property&gt;</span><br><span class="line">&lt;name&gt;dfs.namenode.secondary.http-address&lt;/name&gt;</span><br><span class="line">&lt;value&gt;slave3:50090&lt;/value&gt;</span><br><span class="line">&lt;/property&gt;</span><br><span class="line">&lt;/configuration&gt;</span><br></pre></td></tr></table></figure></p>
<p>3、mapred-site.xml
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&lt;configuration&gt;</span><br><span class="line">&lt;property&gt;</span><br><span class="line">&lt;name&gt;mapreduce.framework.name&lt;/name&gt;</span><br><span class="line">&lt;value&gt;yarn&lt;/value&gt;</span><br><span class="line">&lt;/property&gt;</span><br><span class="line">&lt;/configuration&gt;</span><br></pre></td></tr></table></figure></p>
<p>4、yarn-site.xml
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">&lt;configuration&gt;</span><br><span class="line">&lt;property&gt;</span><br><span class="line">&lt;name&gt;yarn.resourcemanager.hostname&lt;/name&gt;</span><br><span class="line">&lt;value&gt;master&lt;/value&gt;</span><br><span class="line">&lt;/property&gt;</span><br><span class="line">&lt;property&gt;</span><br><span class="line">&lt;name&gt;yarn.nodemanager.aux-services&lt;/name&gt;</span><br><span class="line">&lt;value&gt;mapreduce_shuffle&lt;/value&gt;</span><br><span class="line">&lt;/property&gt;</span><br><span class="line">&lt;/configuration&gt;</span><br></pre></td></tr></table></figure></p>
<p>5、添加数据节点slave
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">编辑slaves</span><br><span class="line">添加主机名 slave1 slave2 各占一行</span><br></pre></td></tr></table></figure></p>
<p>6、添加SNN主机
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">新建masters文件</span><br><span class="line">添加主机名 slave3</span><br></pre></td></tr></table></figure></p>
<p>7、将修改过的配置文件，复制到所有的机器上。</p>
<h3>4、修改主机名、网络</h3>
<p>a)
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">sudo vim /etc/hostname</span><br><span class="line">``` </span><br><span class="line">对应修改为 master slave1 slave2 slave3</span><br><span class="line">b)</span><br></pre></td></tr></table></figure></p>
<p>sudo vim /etc/hosts
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">添加相应的网络设置</span><br><span class="line">如果是ubuntu 把第二行127.0.1.1注释掉.</span><br></pre></td></tr></table></figure></p>
<p>192.168.0.190    master
192.168.0.192    slave1
192.168.0.197    slave2
192.168.0.198    slave3
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">将修改后的hosts文件覆盖所有机器.</span><br><span class="line">远程覆盖： </span><br><span class="line">``` </span><br><span class="line">scp /etc/hosts jiutian@slave1:/etc/</span><br></pre></td></tr></table></figure></p>
<h3>5、启动hadoop</h3>
<p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">    ./usr/local/hadoop/sbin/start-all.sh</span><br></pre></td></tr></table></figure></p>
<p>通过jps查看运行信息
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">        1、master</span><br><span class="line">                    jps、RM、NN</span><br><span class="line">        2、slave1 slave2</span><br><span class="line">                    jps、DN、NM</span><br><span class="line">        3、slave3</span><br><span class="line">                    jps、SNN</span><br></pre></td></tr></table></figure></p>
<h3>6、hdfs创建目录 上传文件</h3>
<p>创建目录
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">./bin/hdfs dfs -mkdir -p /user/jiutian</span><br><span class="line">./bin/hdfs dfs -mkdir input</span><br></pre></td></tr></table></figure></p>
<p>上传文件
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">./bin/hdfs dfs -put ./etc/hadoop/*.xml input</span><br></pre></td></tr></table></figure></p>
<p>下载文件
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">./bin/hdfs dfs -get output ./output    # 将 HDFS 上的 output 文件夹拷贝到本机</span><br></pre></td></tr></table></figure></p>
<p>删除文件
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">./bin/hdfs dfs -rm -r output    # 删除 output 文件夹</span><br></pre></td></tr></table></figure></p>
<p>7、Web管理
<img src="/.io//7a59bbc1-d12f-46a0-8c75-f4c0c7c31d2b.jpg" alt="web管理图"></p>

          
        
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2016/06/19/cx-Oracle库使用/" itemprop="url">
                  cx_Oracle库使用
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">发表于</span>
            <time itemprop="dateCreated" datetime="2016-06-19T11:22:12+08:00" content="2016-06-19">
              2016-06-19
            </time>
          </span>

          

          
            
              <span class="post-comments-count">
                &nbsp; | &nbsp;
                <a href="/2016/06/19/cx-Oracle库使用/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count ds-thread-count" data-thread-key="2016/06/19/cx-Oracle库使用/" itemprop="commentsCount"></span>
                </a>
              </span>
            
          

          

          
          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2>cx_Oracle使用</h2>
<p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> cx_Oracle <span class="keyword">as</span> orcl</span><br><span class="line">print(orcl.clientversion())</span><br><span class="line">username = <span class="string">"scott"</span></span><br><span class="line">passwd = <span class="string">"123456"</span></span><br><span class="line">host = <span class="string">"192.168.1.116"</span></span><br><span class="line">port = <span class="string">"1521"</span></span><br><span class="line">sid = <span class="string">"orcl"</span></span><br><span class="line">dsn = orcl.makedsn(host, port,service_name= sid)</span><br><span class="line">con = orcl.connect(username, passwd, dsn)</span><br><span class="line">cursor = con.cursor()</span><br><span class="line">sql = <span class="string">"SELECT ENAME, EMPNO FROM EMP"</span></span><br><span class="line">cursor.execute(sql);</span><br><span class="line">result = cursor.fetchall()</span><br><span class="line">print(<span class="string">"Total: "</span> + str(cursor.rowcount))</span><br><span class="line"><span class="keyword">for</span> row <span class="keyword">in</span> result:</span><br><span class="line">	print(row)</span><br><span class="line"> </span><br><span class="line">cursor.close()</span><br><span class="line">con.close()</span><br><span class="line">print(orcl.Date(<span class="number">2015</span>,<span class="number">3</span>,<span class="number">13</span>))</span><br></pre></td></tr></table></figure></p>
<h2>web2py中间件pydal使用</h2>
<p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">from gluon import DAL, Field</span><br><span class="line">db = DAL(&apos;oracle://scott/tiger@192.168.1.100:1521/orcl&apos;)</span><br><span class="line">db.define_table(&apos;dept&apos;,Field(&apos;DEPINO&apos;),Field(&apos;DNAME&apos;),Field(&apos;LOC&apos;))</span><br><span class="line">print db(db.test.DEPINO != &quot;&quot;).select()</span><br></pre></td></tr></table></figure></p>
<h2>其他</h2>
<p>创建数据库、创建数据表语句。
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">#表结构复制</span><br><span class="line">create database link orcl CONNECT TO GW IDENTIFIED BY &quot;******&quot; USING &apos;R5DEV_223&apos;;  </span><br><span class="line">CREATE TABLE testout.tab_users AS SELECT * FROM xyzdev.tab_users@orcl;  </span><br><span class="line">create table testout.tab_users as select * from xyzdev.tab_users where 1=2</span><br></pre></td></tr></table></figure></p>

          
        
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
  </section>

  
  <nav class="pagination">
    <span class="page-number current">1</span><a class="page-number" href="/page/2/">2</a><a class="extend next" rel="next" href="/page/2/"><i class="fa fa-angle-right"></i></a>
  </nav>



          </div>
          


          

        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    <div class="sidebar-inner">

      

      

      <section class="site-overview sidebar-panel  sidebar-panel-active ">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <img class="site-author-image" itemprop="image"
               src="https://avatars0.githubusercontent.com/u/8065436?v=3&u=7d0f2353e09344c8fd8c80123fc1b8e1764f7e9c&s=140"
               alt="九天" />
          <p class="site-author-name" itemprop="name">九天</p>
          <p class="site-description motion-element" itemprop="description">网络协议分析、爬虫、python、TensorFlow，以及各种让我痴迷的新技术。</p>
        </div>
        <nav class="site-state motion-element">
          <div class="site-state-item site-state-posts">
            <a href="/archives">
              <span class="site-state-item-count">13</span>
              <span class="site-state-item-name">日志</span>
            </a>
          </div>
          
          

          
            <div class="site-state-item site-state-tags">
              <a href="/tags">
                <span class="site-state-item-count">27</span>
                <span class="site-state-item-name">标签</span>
              </a>
            </div>
          

        </nav>

        

        <div class="links-of-author motion-element">
          
            
              <span class="links-of-author-item">
                <a href="https://github.com/closethe" target="_blank">
                  
                    <i class="fa fa-globe"></i> Github
                  
                </a>
              </span>
            
              <span class="links-of-author-item">
                <a href="mailto:406226143@qq.com" target="_blank">
                  
                    <i class="fa fa-globe"></i> Email
                  
                </a>
              </span>
            
          
        </div>

        
        

        <div class="links-of-author motion-element">
          
        </div>

      </section>

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright" >
  
  &copy; 
  <span itemprop="copyrightYear">2019</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">九天</span>
</div>

<div class="powered-by">
  由 <a class="theme-link" href="http://hexo.io">Hexo</a> 强力驱动
</div>

<div class="theme-info">
  主题 -
  <a class="theme-link" href="https://github.com/iissnan/hexo-theme-next">
    NexT.Mist
  </a>
</div>



      </div>
    </footer>

    <div class="back-to-top">
      <i class="fa fa-arrow-up"></i>
    </div>
  </div>

  


  




<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>


  <script type="text/javascript" src="/vendors/jquery/index.js?v=2.1.3"></script>

  <script type="text/javascript" src="/vendors/fastclick/lib/fastclick.min.js?v=1.0.6"></script>

  <script type="text/javascript" src="/vendors/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>

  <script type="text/javascript" src="/vendors/velocity/velocity.min.js"></script>

  <script type="text/javascript" src="/vendors/velocity/velocity.ui.min.js"></script>

  <script type="text/javascript" src="/vendors/fancybox/source/jquery.fancybox.pack.js"></script>


  


  <script type="text/javascript" src="/js/src/utils.js?v=0.5.0"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=0.5.0"></script>



  
  

  

  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=0.5.0"></script>



  

  
    
  

  <script type="text/javascript">
    var duoshuoQuery = {short_name:"closethe"};
    (function() {
      var ds = document.createElement('script');
      ds.type = 'text/javascript';ds.async = true;
      ds.id = 'duoshuo-script';
      ds.src = (document.location.protocol == 'https:' ? 'https:' : 'http:') + '//static.duoshuo.com/embed.js';
      ds.charset = 'UTF-8';
      (document.getElementsByTagName('head')[0]
      || document.getElementsByTagName('body')[0]).appendChild(ds);
    })();
  </script>

  
    
  





  
  
  

  


</body>
</html>
